"use strict";var utilityButtonLink="u-displayInlineFlex u-flex--centerBlock u-paddingInline--half u-fontBold u-c--grey-min u-bg--grey-max h_u-c--grey-min h_u-bg--grey-max u-border u-border--grey-med h_u-border--accent u-border-radius h_u-glowBox--accent h_u-textShadow--currentBg";window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},document.addEventListener("DOMContentLoaded",function(){var e="data-about-action",t=document.querySelectorAll("["+e+"]");if(t){for(var a=0;a<t.length;a++)if(!t[a].closest("svg")){var n=t[a].innerHTML,o=t[a].getAttribute(e),r='<button class="button--reset '+utilityButtonLink+'" '+e+'="'+o+'">'+n+"</button>";t[a].outerHTML=r}(t=Array.from(document.querySelectorAll("["+e+"]"))).forEach(function(t){"hooked-delorean"===t.getAttribute(e)&&t.addEventListener("click",function(){document.querySelector(".about__delorean").classList.toggle("about__delorean--with-hook")},!1),"synth-set-type"===t.getAttribute(e)&&t.addEventListener("click",function(e){return e.preventDefault(),document.querySelector('[data-synth-type][aria-pressed="true"]').setAttribute("aria-pressed","false"),t.setAttribute("aria-pressed","true"),!1},!1)}),reLabelKeys()}});var audioContext=new(window.AudioContext||window.webkitAudioContext),octaveOffset=1,keyNoteMap=[{note:"C",octave:1,key:"A"},{note:"C#",octave:1,key:"W"},{note:"D",octave:1,key:"S"},{note:"D#",octave:1,key:"E"},{note:"E",octave:1,key:"D"},{note:"F",octave:1,key:"F"},{note:"F#",octave:1,key:"T"},{note:"G",octave:1,key:"G"},{note:"G#",octave:1,key:"Y"},{note:"A",octave:2,key:"H"},{note:"A#",octave:2,key:"U"},{note:"B",octave:2,key:"J"},{note:"C",octave:2,key:"K"}];function getHz(){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4,t=0;switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"A"){default:case"A":t=0;break;case"A#":case"Bb":t=1;break;case"B":t=2;break;case"C":t=3;break;case"C#":case"Db":t=4;break;case"D":t=5;break;case"D#":case"Eb":t=6;break;case"E":t=7;break;case"F":t=8;break;case"F#":case"Gb":t=9;break;case"G":t=10;break;case"G#":case"Ab":t=11}return t+=12*(e-4),440*Math.pow(2,t/12)}function playKey(e){var t=document.querySelector('[data-synth-type][aria-pressed="true"]').getAttribute("data-synth-type")||"sinewave",a=audioContext.createOscillator(),n=audioContext.createGain();n.connect(audioContext.destination);n.gain.value=1e-5;n.gain.exponentialRampToValueAtTime(.5,audioContext.currentTime+.01),n.gain.exponentialRampToValueAtTime(.001,audioContext.currentTime+1),n.gain.exponentialRampToValueAtTime(1e-5,audioContext.currentTime+2),a.connect(n),a.type=t;var o=getHz(e.note,(e.octave||0)+octaveOffset);Number.isFinite(o)&&(a.frequency.value=o),e.element.classList.add("pressed"),pressedNotes.set(e,a),pressedNotes.get(e).start()}function stopKey(e){if(e){e.element.classList.remove("pressed");var t=pressedNotes.get(e);t&&(setTimeout(function(){t.stop()},2e3),pressedNotes.delete(e))}}var getNoteByKey=function(t){return keyNoteMap.find(function(e){return e.key===t})||!1},getKeyByNoteOctave=function(t,a){return keyNoteMap.find(function(e){return e.note===t&&e.octave===parseInt(a,10)})||!1},pressedNotes=new Map,clickedKey="";function reLabelKeys(){Array.from(document.querySelectorAll("[data-note]")).forEach(function(e){var t=e.getAttribute("data-note"),a=parseInt(e.getAttribute("data-octave"),10),n=getKeyByNoteOctave(t,a).key;e.innerText=n})}function triggerKey(e,t,a){var n={element:e,note:t,octave:a};playKey(clickedKey=n)}document.addEventListener("mousedown",function(e){var t=e.target.closest("[data-note]");if(t)return e.preventDefault(),triggerKey(t,t.getAttribute("data-note"),parseInt(t.getAttribute("data-octave"),10)),!1},!1),document.addEventListener("mouseup",function(){stopKey(clickedKey)},!1),document.addEventListener("keydown",function(e){var t=e.key.toUpperCase();if(!(e.altKey||e.metaKey||e.ctrlKey||e.shiftKey))if("ENTER"!==t&&" "!==t){var a=getNoteByKey(t);if(a){var n={element:document.querySelector('[data-note="'.concat(a.note,'"][data-octave="').concat(a.octave,'"]')),note:a.note,octave:a.octave};playKey(clickedKey=n)}}else{var o=e.target.closest("[data-note]");if(!o)return;triggerKey(o,o.getAttribute("data-note"),parseInt(o.getAttribute("data-octave"),10))}}),document.addEventListener("keyup",function(){stopKey(clickedKey)},!1);