"use strict";var utilityButtonLink="u-displayInlineFlex u-flex--centerBlock u-paddingInline--half u-fontBold u-c--grey-min u-bg--grey-max h_u-c--grey-min h_u-bg--grey-max u-border u-border--grey-med h_u-border--accent u-border-radius h_u-glowBox--accent h_u-textShadow--currentBg";window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};var vhsWrapper=!1,vhsTapesList=[],mousePosition={x:!1,y:!1,new:!0};function numClamp(e,t,o){return Math.min(Math.max(t,e),o)}function numRemap(e,t,o,n,a){return(a-n)/(o-t)*(e-t)+n}function getXOffset(e,t){for(var o=0;e&&!isNaN(e.offsetLeft);)o+=e.offsetLeft-e.scrollLeft,e=e.offsetParent;return t-o}function orientVhsTapes(){if(requestAnimationFrame(orientVhsTapes),!1!==mousePosition.new&&!1!==mousePosition.x){var e=getXOffset(vhsWrapper,mousePosition.x),t=vhsWrapper.offsetWidth,i=Math.round(t/4),s=numClamp(-1*i,e,t+i);vhsTapesList.forEach(function(e){var t=e.offsetLeft,o=e.offsetWidth,n=t-i,a=t+o+i,r=numRemap(numClamp(n,s,a),n,a,-1,1);e.style.setProperty("--orientation-factor",r)})}}document.addEventListener("DOMContentLoaded",function(){var e="data-about-action",t=document.querySelectorAll("["+e+"]");if(t){for(var o=0;o<t.length;o++)if(!t[o].closest("svg")){var n=t[o].innerHTML,a=t[o].getAttribute(e),r='<button class="button--reset '+utilityButtonLink+'" '+e+'="'+a+'">'+n+"</button>";t[o].outerHTML=r}(t=Array.from(document.querySelectorAll("["+e+"]"))).forEach(function(t){"hooked-delorean"===t.getAttribute(e)&&t.addEventListener("click",function(){document.querySelector(".about__delorean").classList.toggle("about__delorean--with-hook")},!1),"synth-set-type"===t.getAttribute(e)&&t.addEventListener("click",function(e){return e.preventDefault(),document.querySelector('[data-synth-type][aria-pressed="true"]').setAttribute("aria-pressed","false"),t.setAttribute("aria-pressed","true"),!1},!1)})}reLabelKeys(),showMelodies(),vhsWrapper=document.querySelector('[data-grid-el="trinket-designs"]'),vhsTapesList=Array.from(document.querySelectorAll(".about__vhs")),setTimeout(orientVhsTapes,100)});var melodies=[["D","D","D","A","G","D","A","G","D","J","J","J","K","G","E","A","G","D"],["G","Y","G","Y","G","F","Y","G","A","G","Y","G","Y","G","F","Y","G","K"],["A","S","D","G","D","S","A","D","G","H","K","J","G","D","F","D","S"]],audioContext=new(window.AudioContext||window.webkitAudioContext),octaveOffset=1,keyNoteMap=[{note:"C",octave:1,key:"A",keyAzerty:"Q"},{note:"C#",octave:1,key:"W",keyAzerty:"Z"},{note:"D",octave:1,key:"S",keyAzerty:"S"},{note:"D#",octave:1,key:"E",keyAzerty:"E"},{note:"E",octave:1,key:"D",keyAzerty:"D"},{note:"F",octave:1,key:"F",keyAzerty:"F"},{note:"F#",octave:1,key:"T",keyAzerty:"T"},{note:"G",octave:1,key:"G",keyAzerty:"G"},{note:"G#",octave:1,key:"Y",keyAzerty:"Y"},{note:"A",octave:2,key:"H",keyAzerty:"H"},{note:"A#",octave:2,key:"U",keyAzerty:"U"},{note:"B",octave:2,key:"J",keyAzerty:"J"},{note:"C",octave:2,key:"K",keyAzerty:"K"}];function getAzertyForKey(t){return keyNoteMap.find(function(e){return e.key===t}).keyAzerty}function getHz(){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4,t=0;switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"A"){default:case"A":t=0;break;case"A#":case"Bb":t=1;break;case"B":t=2;break;case"C":t=3;break;case"C#":case"Db":t=4;break;case"D":t=5;break;case"D#":case"Eb":t=6;break;case"E":t=7;break;case"F":t=8;break;case"F#":case"Gb":t=9;break;case"G":t=10;break;case"G#":case"Ab":t=11}return t+=12*(e-4),440*Math.pow(2,t/12)}function playKey(e){var t=document.querySelector('[data-synth-type][aria-pressed="true"]').getAttribute("data-synth-type")||"sinewave",o=audioContext.createOscillator(),n=audioContext.createGain();n.connect(audioContext.destination);n.gain.value=1e-5;n.gain.exponentialRampToValueAtTime(.5,audioContext.currentTime+.01),n.gain.exponentialRampToValueAtTime(.001,audioContext.currentTime+1),n.gain.exponentialRampToValueAtTime(1e-5,audioContext.currentTime+2),o.connect(n),o.type=t;var a=getHz(e.note,(e.octave||0)+octaveOffset);Number.isFinite(a)&&(o.frequency.value=a),e.element.classList.add("pressed"),pressedNotes.set(e,o),pressedNotes.get(e).start()}function stopKey(e){if(e){e.element.classList.remove("pressed");var t=pressedNotes.get(e);t&&(setTimeout(function(){t.stop()},2e3),pressedNotes.delete(e))}}var getNoteByKey=function(t){return keyNoteMap.find(function(e){return("AZERTY"===getKeyboardLayout()?e.keyAzerty:e.key)===t})||!1},getKeyByNoteOctave=function(t,o){return keyNoteMap.find(function(e){return e.note===t&&e.octave===parseInt(o,10)})||!1},pressedNotes=new Map,clickedKey="";function getKeyboardLayout(){return(document.querySelector("[data-about-keyboard-melodies]").getAttribute("data-about-keyboard-melodies")||"QWERTY").toUpperCase()}function reLabelKeys(){Array.from(document.querySelectorAll("[data-note]")).forEach(function(e){var t=e.getAttribute("data-note"),o=parseInt(e.getAttribute("data-octave"),10),n=getKeyByNoteOctave(t,o),a="AZERTY"===getKeyboardLayout()?n.keyAzerty:n.key;e.innerText=a})}function showMelodies(){var a="AZERTY"===getKeyboardLayout(),r=document.querySelector("[data-about-keyboard-melodies]");melodies.forEach(function(e){var t=document.createElement("br"),o=document.createElement("kbd"),n=a?e.map(function(e){return getAzertyForKey(e)}):e;o.innerText=n.join(", ")+".",r.appendChild(t),r.appendChild(o)}),r.hidden=!1}function triggerKey(e,t,o){var n={element:e,note:t,octave:o};playKey(clickedKey=n)}document.addEventListener("mousemove",function(e){mousePosition.new=e.clientX!==mousePosition.x||e.clientY!==mousePosition.y,mousePosition.x=e.clientX,mousePosition.y=e.clientY},!1),document.addEventListener("mousedown",function(e){var t=e.target.closest("[data-note]");if(t)return e.preventDefault(),triggerKey(t,t.getAttribute("data-note"),parseInt(t.getAttribute("data-octave"),10)),!1},!1),document.addEventListener("mouseup",function(){stopKey(clickedKey)},!1),document.addEventListener("keydown",function(e){var t=e.key.toUpperCase();if(!(e.altKey||e.metaKey||e.ctrlKey||e.shiftKey))if("ENTER"!==t&&" "!==t){var o=getNoteByKey(t);if(o){var n={element:document.querySelector('[data-note="'.concat(o.note,'"][data-octave="').concat(o.octave,'"]')),note:o.note,octave:o.octave};playKey(clickedKey=n)}}else{var a=e.target.closest("[data-note]");if(!a)return;triggerKey(a,a.getAttribute("data-note"),parseInt(a.getAttribute("data-octave"),10))}}),document.addEventListener("keyup",function(){stopKey(clickedKey)},!1);